<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live TV Streaming - Professional</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanilla-tilt@1.8.1/dist/vanilla-tilt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: #fff;
        }
        #video-container {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
        }
        #live-stream {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            background-color: #000;
        }
        #channel-menu {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.9), rgba(0, 0, 30, 0.8));
            backdrop-filter: blur(15px);
            padding: 30px;
            border-radius: 20px;
            z-index: 1000;
            text-align: center;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.7);
            min-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            border: 2px solid rgba(0, 123, 255, 0.3);
            animation: slideIn 0.4s ease-out forwards;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translate(-50%, -60%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        #channel-menu h3 {
            margin: 0 0 20px;
            font-size: 2em;
            color: #fff;
            text-shadow: 0 2px 6px rgba(0, 123, 255, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        #channel-menu h3 i {
            color: #007bff;
        }
        #channel-list {
            list-style: none;
            padding: 0;
            margin: 0 0 20px;
        }
        #channel-list li {
            padding: 15px 25px;
            font-size: 1.4em;
            color: #fff;
            cursor: pointer;
            border-radius: 10px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            transition: background 0.3s, transform 0.3s;
        }
        #channel-list li:hover, #channel-list li.selected {
            background: linear-gradient(90deg, rgba(0, 123, 255, 0.8), rgba(0, 80, 200, 0.8));
            transform: translateX(10px);
        }
        #channel-list li i {
            font-size: 1.2em;
            color: #007bff;
        }
        #channel-list li.hidden {
            display: none;
        }
        #channel-input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }
        #channel-input {
            width: 120px;
            padding: 12px;
            font-size: 1.3em;
            text-align: center;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.15);
            color: #fff;
            transition: background 0.3s, box-shadow 0.3s;
        }
        #channel-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        #channel-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 12px rgba(0, 123, 255, 0.6);
        }
        #channel-input-label {
            font-size: 1.3em;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        #channel-input-label i {
            color: #007bff;
        }
        #progress-bar {
            display: none;
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }
        #progress-fill {
            width: 0;
            height: 100%;
            background: #007bff;
            transition: width 3s linear;
        }
        #footer {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
            z-index: 5;
        }
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 999;
            pointer-events: none;
        }
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 123, 255, 0.5);
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="video-container">
        <video id="live-stream" autoplay playsinline></video>
    </div>
    <div id="channel-menu">
        <div id="particles-js"></div>
        <h3><i class="fas fa-tv"></i> Channel List</h3>
        <ul id="channel-list">
            <li data-channel="1"><i class="fas fa-newspaper"></i> 1. Al Jazeera</li>
            <li data-channel="2"><i class="fas fa-globe"></i> 2. Oman TV</li>
            <li data-channel="3"><i class="fas fa-mosque"></i> 3. Al Istiqama</li>
            <li data-channel="4"><i class="fas fa-futbol"></i> 4. Oman Sports</li>
            <li data-channel="5"><i class="fas fa-binoculars"></i> 5. National Geographic Abu Dhabi</li>
            <li data-channel="6"><i class="fas fa-newspaper"></i> 6. Al Arabiya</li>
            <li data-channel="7"><i class="fas fa-child"></i> 7. Spacetoon</li>
        </ul>
        <div id="channel-input-container">
            <label id="channel-input-label" for="channel-input"><i class="fas fa-search"></i> Enter Number or Name:</label>
            <input type="text" id="channel-input" maxlength="20" placeholder="1-7 or Name">
        </div>
        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>
    </div>
    <div id="footer">Developed by ins:abdullah__krs</div>

    <script>
        // Channel links
        const channels = {
            1: 'https://live-hls-web-aja.getaj.net/AJA/index.m3u8', // Al Jazeera
            2: 'https://partwota.cdn.mgmlcdn.com/omlive/smil:omlive.stream.smil/chunklist.m3u8', // Oman TV
            3: 'https://jmc-live.ercdn.net/alistiqama/alistiqama.m3u8', // Al Istiqama
            4: 'https://partneta.cdn.mgmlcdn.com/omsport/smil:omsport.stream.smil/chunklist.m3u8', // Oman Sports
            5: 'https://mobi.jawaltv.com/pyr/msg/soon/playlist.m3u8', // National Geographic Abu Dhabi
            6: 'https://live.alarabiya.net/alarabiapublish/alarabiya.smil/playlist.m3u8', // Al Arabiya
            7: 'https://streams.spacetoon.com/live/stchannel/smil:livesmil.smil/playlist.m3u8' // Spacetoon
        };

        // Channel names for filtering
        const channelNames = {
            1: 'Al Jazeera',
            2: 'Oman TV',
            3: 'Al Istiqama',
            4: 'Oman Sports',
            5: 'National Geographic Abu Dhabi',
            6: 'Al Arabiya',
            7: 'Spacetoon'
        };

        // Switch channel
        function changeChannel(channelNumber) {
            const video = document.getElementById('live-stream');

            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(channels[channelNumber]);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    video.play().catch(error => {
                        console.error('Video playback error:', error);
                    });
                });
                hls.on(Hls.Events.ERROR, (event, data) => {
                    if (data.fatal) {
                        console.error('HLS fatal error:', data);
                    }
                });
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = channels[channelNumber];
                video.play().catch(error => {
                    console.error('Video playback error:', error);
                });
            } else {
                console.error('HLS not supported in this browser');
            }

            video.muted = false;
            video.volume = 1.0;
            hideChannelMenu();
        }

        // Show channel menu
        function showChannelMenu() {
            const menu = document.getElementById('channel-menu');
            menu.style.display = 'block';
            const input = document.getElementById('channel-input');
            input.value = '';
            input.focus();
            filterChannels('');
            isMenuOpen = true;
            updateSelectedChannel(0);
            initParticles();
            VanillaTilt.init(document.querySelectorAll('#channel-list li'), {
                max: 15,
                speed: 400,
                glare: true,
                'max-glare': 0.3
            });
            // Play click sound
            playClickSound();
        }

        // Hide channel menu
        function hideChannelMenu() {
            const menu = document.getElementById('channel-menu');
            menu.style.display = 'none';
            isMenuOpen = false;
            stopProgressBar();
            // Destroy tilt effects to save resources
            document.querySelectorAll('#channel-list li').forEach(item => {
                if (item.vanillaTilt) item.vanillaTilt.destroy();
            });
        }

        // Variables
        let channelInputTimer;
        let isMenuOpen = false;
        let selectedIndex = 0;

        // Update selected channel
        function updateSelectedChannel(index) {
            const channelItems = document.querySelectorAll('#channel-list li:not(.hidden)');
            channelItems.forEach((item, i) => {
                item.classList.toggle('selected', i === index);
            });
            selectedIndex = index;
            // Scroll selected item into view
            if (channelItems[index]) {
                channelItems[index].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // Handle channel input with 3-second delay
        function handleChannelInput(channelNumber) {
            const input = document.getElementById('channel-input');
            input.value = channelNumber;
            clearTimeout(channelInputTimer);
            if (channelNumber && channels[channelNumber]) {
                startProgressBar();
                channelInputTimer = setTimeout(() => {
                    changeChannel(channelNumber);
                }, 3000);
            }
        }

        // Filter channels by name or number
        function filterChannels(query) {
            const channelItems = document.querySelectorAll('#channel-list li');
            let visibleIndex = 0;
            channelItems.forEach((item, index) => {
                const channelNumber = item.getAttribute('data-channel');
                const channelName = channelNames[channelNumber].toLowerCase();
                const isMatch = channelNumber.includes(query) || channelName.includes(query.toLowerCase());
                item.classList.toggle('hidden', !isMatch);
                if (isMatch && visibleIndex === selectedIndex) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
                if (isMatch) visibleIndex++;
            });
            // Reset selected index if no items are visible
            if (visibleIndex === 0) selectedIndex = 0;
            updateSelectedChannel(selectedIndex);
        }

        // Start progress bar
        function startProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            progressBar.style.display = 'block';
            progressFill.style.width = '0';
            setTimeout(() => {
                progressFill.style.width = '100%';
            }, 10);
        }

        // Stop progress bar
        function stopProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            progressBar.style.display = 'none';
            progressFill.style.width = '0';
        }

        // Play click sound
        function playClickSound() {
            const audio = new Audio('https://cdn.pixabay.com/audio/2023/02/14/audio_7c90ebbcf0.mp3');
            audio.volume = 0.3;
            audio.play().catch(error => console.log('Sound playback error:', error));
        }

        // Initialize particles
        function initParticles() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 50, density: { enable: true, value_area: 800 } },
                    color: { value: '#007bff' },
                    shape: { type: 'circle' },
                    opacity: { value: 0.5, random: true },
                    size: { value: 3, random: true },
                    line_linked: { enable: false },
                    move: { enable: true, speed: 2, direction: 'none', random: true }
                },
                interactivity: {
                    detect_on: 'canvas',
                    events: { onhover: { enable: false }, onclick: { enable: false }, resize: true }
                }
            });
        }

        // Handle keyboard events
        function handleKeyEvent(event) {
            const key = event.key;
            const keyCode = event.keyCode || event.which;
            console.log('Key pressed:', key, 'KeyCode:', keyCode);

            if (key === '0' || key === 'Home' || keyCode === 48 || keyCode === 36) {
                event.preventDefault();
                showChannelMenu();
            } else if (isMenuOpen && (key >= '1' && key <= '7' || (keyCode >= 49 && keyCode <= 55))) {
                event.preventDefault();
                handleChannelInput(key);
            } else if (key >= '1' && key <= '7' || (keyCode >= 49 && keyCode <= 55)) {
                event.preventDefault();
                changeChannel(key);
            } else if (isMenuOpen && (key === 'ArrowUp' || keyCode === 38)) {
                event.preventDefault();
                const visibleItems = document.querySelectorAll('#channel-list li:not(.hidden)');
                updateSelectedChannel(Math.max(0, selectedIndex - 1));
            } else if (isMenuOpen && (key === 'ArrowDown' || keyCode === 40)) {
                event.preventDefault();
                const visibleItems = document.querySelectorAll('#channel-list li:not(.hidden)');
                updateSelectedChannel(Math.min(visibleItems.length - 1, selectedIndex + 1));
            } else if (isMenuOpen && (key === 'Enter' || keyCode === 13)) {
                event.preventDefault();
                const selectedChannel = document.querySelector('#channel-list li.selected');
                if (selectedChannel) {
                    const channelNumber = selectedChannel.getAttribute('data-channel');
                    changeChannel(channelNumber);
                    playClickSound();
                }
            } else if (key === 'Escape' || key === 'c' || keyCode === 27 || keyCode === 67) {
                event.preventDefault();
                hideChannelMenu();
            } else if (isMenuOpen && (key === 'f' || keyCode === 70)) {
                event.preventDefault();
                document.getElementById('channel-input').focus();
            }
        }

        // Add keyboard event listeners
        document.addEventListener('keydown', handleKeyEvent, { capture: true });
        document.getElementById('video-container').addEventListener('keydown', handleKeyEvent, { capture: true });

        // Handle channel list clicks
        document.querySelectorAll('#channel-list li').forEach(item => {
            item.addEventListener('click', () => {
                const channelNumber = item.getAttribute('data-channel');
                changeChannel(channelNumber);
                playClickSound();
            });
        });

        // Handle input field
        document.getElementById('channel-input').addEventListener('input', function() {
            clearTimeout(channelInputTimer);
            const input = this.value;
            filterChannels(input);
            if (input && channels[input]) {
                startProgressBar();
                channelInputTimer = setTimeout(() => {
                    changeChannel(input);
                }, 3000);
            } else {
                stopProgressBar();
            }
        });

        // Handle mouse wheel scroll
        document.getElementById('channel-menu').addEventListener('wheel', (event) => {
            if (isMenuOpen) {
                event.preventDefault();
                const visibleItems = document.querySelectorAll('#channel-list li:not(.hidden)');
                if (event.deltaY > 0) {
                    updateSelectedChannel(Math.min(visibleItems.length - 1, selectedIndex + 1));
                } else {
                    updateSelectedChannel(Math.max(0, selectedIndex - 1));
                }
            }
        });

        // Initialize first channel (Al Jazeera)
        window.onload = function() {
            const video = document.getElementById('live-stream');
            changeChannel(1); // Start with Al Jazeera
            video.muted = false;
            video.volume = 1.0;
        };
    </script>
</body>
</html>
